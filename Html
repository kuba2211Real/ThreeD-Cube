<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ThreeD Cube</title>
  <style>
    :root{
      --size: 180px;
      --half: calc(var(--size) / 2);
    }
    html,body{height:100%;margin:0}
    body{
      display:flex;
      flex-direction: column;
      align-items:center;
      justify-content:center;
      background:#000;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      user-select: none;
      overflow: hidden;
      gap: 15px;
      padding: 20px;
      color: #eee;
    }

    .controls {
      display: flex;
      gap: 15px;
      align-items: center;
      user-select: none;
    }

    .scene{
      width: calc(var(--size) * 3);
      height: calc(var(--size) * 3);
      perspective: 900px;
    }

    .cube-wrap{
      width: var(--size);
      height: var(--size);
      margin:auto;
      transform-style: preserve-3d;
      transform-origin: center center;
      position:relative;
      cursor: grab;
      transition: cursor 0.2s;
      transform: translateY(50px) rotateX(40deg) rotateY(0deg);
    }
    .cube-wrap:active {
      cursor: grabbing;
    }

    .cube{
      width:100%;
      height:100%;
      position:relative;
      transform-style: preserve-3d;
    }

    .face{
      position:absolute;
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      backface-visibility: hidden;
      background: #fff;
      box-shadow: 0 6px 30px rgba(0,0,0,0.6) inset;
      border: 1px solid rgba(0,0,0,0.08);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .face.front  { transform: translateZ(var(--half)); }
    .face.back   { transform: rotateY(180deg) translateZ(var(--half)); }
    .face.right  { transform: rotateY(90deg) translateZ(var(--half)); }
    .face.left   { transform: rotateY(-90deg) translateZ(var(--half)); }
    .face.top    { transform: rotateX(90deg) translateZ(var(--half)); }
    .face.bottom { transform: rotateX(-90deg) translateZ(var(--half)); }

    /* Button style */
    #uploadButton {
      background: #222;
      color: #eee;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      box-shadow: 0 2px 8px rgba(255,255,255,0.2);
      border: none;
      transition: background-color 0.3s;
      font-size: 16px;
    }
    #uploadButton:hover {
      background: #444;
    }

    /* Hidden file input */
    #uploadInput {
      display: none;
    }

    /* Slider */
    #speedSlider {
      -webkit-appearance: none;
      width: 150px;
      height: 6px;
      border-radius: 4px;
      background: #444;
      cursor: pointer;
      outline: none;
      transition: background 0.3s;
    }
    #speedSlider:hover {
      background: #666;
    }
    #speedSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      background: #eee;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 5px rgba(255,255,255,0.8);
      transition: background 0.3s;
    }
    #speedSlider::-moz-range-thumb {
      width: 18px;
      height: 18px;
      background: #eee;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 5px rgba(255,255,255,0.8);
      transition: background 0.3s;
    }

    #speedValue {
      font-weight: 600;
      min-width: 40px;
      text-align: center;
      font-family: monospace;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="controls" aria-label="Cube controls">
    <button id="uploadButton" aria-label="Upload image to the front of the cube">Upload Image</button>
    <input type="file" id="uploadInput" accept="image/*" />
    <label for="speedSlider" style="user-select:none;">Speed:</label>
    <input type="range" id="speedSlider" min="0" max="5" step="0.1" value="0.4" aria-valuemin="0" aria-valuemax="5" aria-valuenow="0.4" aria-label="Cube rotation speed control" />
    <div id="speedValue">0.4</div>
  </div>

  <div class="scene" aria-hidden="false">
    <div class="cube-wrap" role="img" aria-label="Rotating and interactive white 3D cube">
      <div class="cube">
        <div class="face front"></div>
        <div class="face back"></div>
        <div class="face right"></div>
        <div class="face left"></div>
        <div class="face top"></div>
        <div class="face bottom"></div>
      </div>
    </div>
  </div>

  <script>
    (() => {
      const cubeWrap = document.querySelector('.cube-wrap');
      const frontFace = document.querySelector('.face.front');
      const uploadInput = document.getElementById('uploadInput');
      const uploadButton = document.getElementById('uploadButton');
      const speedSlider = document.getElementById('speedSlider');
      const speedValue = document.getElementById('speedValue');

      let rotX = 40;
      let rotY = 0;
      let isDragging = false;
      let startX, startY;

      // Automatic rotation speed, initially from slider value
      let autoRotateSpeed = parseFloat(speedSlider.value);

      let lastTimestamp = null;

      uploadButton.addEventListener('click', () => {
        uploadInput.click();
      });

      speedSlider.addEventListener('input', (e) => {
        autoRotateSpeed = parseFloat(e.target.value);
        speedValue.textContent = autoRotateSpeed.toFixed(1);
      });

      function animate(timestamp) {
        if (!lastTimestamp) lastTimestamp = timestamp;
        const delta = timestamp - lastTimestamp;
        lastTimestamp = timestamp;

        if (!isDragging) {
          rotY += autoRotateSpeed * (delta / 16);
          rotY %= 360;
          updateTransform();
        }

        requestAnimationFrame(animate);
      }

      function updateTransform() {
        cubeWrap.style.transform = `translateY(50px) rotateX(${rotX}deg) rotateY(${rotY}deg)`;
      }

      cubeWrap.addEventListener('mousedown', e => {
        if (e.button !== 0) return;
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        cubeWrap.style.cursor = 'grabbing';
        e.preventDefault();
      });

      window.addEventListener('mouseup', e => {
        if (e.button !== 0) return;
        isDragging = false;
        cubeWrap.style.cursor = 'grab';
      });

      window.addEventListener('mousemove', e => {
        if (!isDragging) return;
        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;
        startX = e.clientX;
        startY = e.clientY;

        rotY += deltaX * 0.5;
        rotX -= deltaY * 0.5;
        rotX = Math.min(90, Math.max(-90, rotX));

        updateTransform();
      });

      uploadInput.addEventListener('change', e => {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (event) => {
          frontFace.style.backgroundImage = `url(${event.target.result})`;
        };
        reader.readAsDataURL(file);
      });

      requestAnimationFrame(animate);
    })();
  </script>
</body>
</html>
